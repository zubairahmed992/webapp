paper.install(window);
$(document).ready(function() {
   paper.setup('canv_mask');  
   overall_mask();
});


function overall_mask(){
    var toe_shape_px=21.885;
    pre_init();
    function pre_init(){
        var liquid_mask = {
            user_height: parseFloat($('#user_height_frm_3').attr('value')),
            //user_height: 74,
            def_mask: $("#default_user_path").html(),
            dm_body_parts_details_json: JSON.parse($("#dm_body_parts_details_json").attr('value')),
            device_type: $("#dv_type").attr("value"),
            device_model: $("#dv_model").attr("value"),
            adjusted_user_mask: function(){return}
        }
        console.log('Jason Data'+ liquid_mask);
        $('#user_bust_px').attr('value',parseFloat(liquid_mask.dm_body_parts_details_json.bust_px));    
        $('#user_waist_px').attr('value',parseFloat(liquid_mask.dm_body_parts_details_json.waist_px));
        $('#user_hip_px').attr('value',parseFloat(liquid_mask.dm_body_parts_details_json.hip_px));

    px_per_inch_ratio = px_per_in_ratio(liquid_mask);
    init(liquid_mask);
    set_arm_rgt();
    }

    hitOptions = {
            segments: true,
            stroke: true,
            fill: true,
            tolerance: 22
    };


    //////// Pixel per inch Ratio based on device type and model
    function px_per_in_ratio(liquid_mask){
        if(liquid_mask.device_type == "iphone6"){
            return 7.958;
        }
    }
    function init(liquid_mask){
        adjusted_mask_height_px = parseFloat(liquid_mask.user_height) * px_per_inch_ratio;
        //this mask wroking currently with flat toe shape
        //path_data = "M79.455,0c7.108,0,20.321,5.66,20.857,20.108c0,3.721,0.007,6.054,0,6.867c-0.011,1.091,2.608-2.602,2.608,5.743c0,4.296-2.366,9.903-5.054,8.937c-1.025,2.34-5.504,13.31-5.444,14.491c0.058,1.253,0.964,10.473,1.375,10.708c1.485,2.146,20.987,7.739,26.146,8.623c14.09,2.414,19.705,14.798,21.612,39.95c0.698,5.082,1.888,37.947,5.508,47.839c3.194,8.364,7.201,57.149,6.448,62.805c-0.632,4.735,15.809,25.89-5.905,47.022c-8.116,7.898-3.771-7.298-4.779-11.292c-7.34-14.66-3.574-28.72-1.302-34.74c0.724-2.605-14.161-41.228-17.126-54.275c-9.765-42.965-2.553-41.912,1.179-57.359c0.727-6.97-0.686-15.036-0.832-15.103c-0.164-0.067,1.768,6.526,0.832,14.117c-2.331,9.806-8.679,22.954-8.679,37.221c0,4.536,1.82,20.22,3.544,24.463c0.583,1.435,2.229,7.75,2.811,9.936c0.968,3.636,2.135,12.348,4.224,20.397c1.278,7.491,5.634,23.716,1.352,46.621c-1.565,10.619-10.74,31.778-13.684,57.761c-0.65,4.184-1.39,11.374-1.116,17.05c0.274,6.275,1.764,18.013,1.496,22.291c-0.372,11.08-12.044,57.033-12.867,63.681c-0.536,4.31,1.666,12.577,2.218,15.636c0.688,3.822,4.708,19.182,6.001,20.477c-0.603,0.059-10.042,0-11.797,0c-1.736,0-11.503,0-11.799,0c0.009-1.847,0.531-33.07,1.036-36.05c0.9-7.582-4.277-49.957-3.646-63.958c0.165-3.204,0.665-15.831-0.105-22.079c-3.317-18.44-3.884-34.317-5.089-74.925c-0.142-2.823,0.125-14.02-0.024-14.02c-0.151,0,0.092,11.197-0.05,14.02c-1.205,40.607-1.772,56.484-5.089,74.925c-0.77,6.248-0.271,18.875-0.105,22.079c0.631,14.001-4.546,56.376-3.646,63.958c0.505,2.98,1.027,34.204,1.036,36.05c-0.296,0-10.063,0-11.799,0c-1.756,0-11.194,0.059-11.797,0c1.293-1.295,5.313-16.654,6.001-20.477c0.552-3.059,2.754-11.326,2.218-15.636c-0.823-6.648-12.495-52.602-12.867-63.681c-0.267-4.278,1.222-16.016,1.496-22.291c0.274-5.676-0.466-12.866-1.115-17.05c-2.944-25.982-12.119-47.142-13.684-57.761c-4.283-22.904,0.074-39.129,1.352-46.621c2.089-8.049,3.256-16.761,4.224-20.397c0.582-2.187,2.228-8.501,2.812-9.936c1.724-4.243,3.544-19.927,3.544-24.463c0-14.267-6.349-27.415-8.68-37.221c-0.936-7.591,0.995-14.185,0.832-14.117c-0.146,0.067-1.559,8.133-0.832,15.103c3.732,15.447,10.943,14.394,1.179,57.359c-2.965,13.047-17.85,51.67-17.126,54.275c2.272,6.021,6.038,20.08-1.302,34.74c-1.008,3.994,3.337,19.19-4.779,11.292c-21.712-21.133-5.272-42.287-5.904-47.022c-0.753-5.656,3.253-54.441,6.447-62.805c3.621-9.892,4.811-42.757,5.509-47.839c1.907-25.151,7.523-37.536,21.613-39.95c5.158-0.884,24.66-6.477,26.145-8.623c0.411-0.235,1.316-9.455,1.375-10.708c0.061-1.181-4.418-12.151-5.444-14.491c-2.688,0.966-5.054-4.641-5.054-8.937c0-8.344,2.619-4.652,2.608-5.743c-0.007-0.813,0-3.146,0-6.867C59.107,5.66,72.463,0,79.455,0z";
        //path_data = "M87.41,0c7.603,0,20.554,5.537,21.09,19.673c0,3.641,0.006,5.923,0,6.718c-0.009,1.067,2.64-2.546,2.64,5.619c0,4.202-2.391,9.688-5.11,8.743c-1.037,2.287-5.567,13.021-5.506,14.177c0.058,1.224,0.974,10.246,1.389,10.475c1.502,2.1,21.507,7.775,26.441,8.071c8.983,1.214,17.814,8.128,22.815,39.45c0.738,5.191,3.961,36.951,7.518,46.35c3.23,8.184,10.604,57.149,9.843,62.684c-0.638,4.633,17.112,25.957-4.845,46.634c-5.753,4.239-2.614-8.962-3.634-12.871c-7.425-14.341-5.628-27.419-3.331-33.307c0.733-2.55-15.126-42.408-20.288-54.506c-3.317-13.9-10.295-29.22-3.081-54.981c0.735-6.82-0.948-14.712-1.093-14.776c-0.165-0.065,1.787,6.386,0.842,13.813c-2.359,9.595-8.519,22.519-8.519,36.477c0,4.438,1.566,20.114,3.31,24.266c0.978,2.331,2.575,8.763,2.895,9.927c0.979,3.561,2.44,12.535,4.551,20.408c1.932,7.202,2.777,34.845,0.976,46.686c-1.584,10.389-9.729,32.29-12.808,54.384c-0.656,4.093-1.404,11.127-1.128,16.681c0.277,6.139,1.374,17.875,1.104,22.06c-0.376,10.839-11.772,62.395-12.604,68.899c-0.539,4.216,3.449,17.342,5.106,20.667c1.803,3.618,9.966,15.615-13.283,17.583c-10.611,0-8.04-6.747-5.751-17.583c0.252-3.371,0.082-6.871,0.113-10.027c0.036-3.572,0.028-5.875,1.01-12.136c1.836-18.476-6.02-54.167-5.38-67.863c0.168-3.134,0.673-15.489-0.106-21.602c-3.355-18.042-1.334-39.765-4.239-69.979c-0.203-3.936-0.721-16.804-0.993-16.804s-0.79,12.868-0.993,16.804c-2.905,30.215-0.884,51.938-4.239,69.979c-0.779,6.112-0.273,18.468-0.105,21.602c0.639,13.696-7.217,49.388-5.381,67.863c0.981,6.261,0.974,8.563,1.01,12.136c0.031,3.156-0.139,6.656,0.113,10.027C80.044,443.253,82.616,450,72.004,450c-23.249-1.968-15.086-13.965-13.283-17.583c1.657-3.325,5.646-16.451,5.106-20.667c-0.832-6.505-12.229-58.061-12.604-68.899c-0.271-4.185,0.826-15.921,1.104-22.06c0.276-5.554-0.472-12.588-1.128-16.681c-3.078-22.094-11.224-43.995-12.808-54.384c-1.802-11.841-0.956-39.483,0.976-46.686c2.11-7.873,3.572-16.848,4.551-20.408c0.319-1.164,1.917-7.596,2.896-9.927c1.742-4.151,3.31-19.827,3.31-24.266c0-13.958-6.16-26.882-8.52-36.477c-0.945-7.427,1.007-13.878,0.842-13.813c-0.145,0.064-1.828,7.956-1.093,14.776c7.214,25.762,0.236,41.081-3.081,54.981c-5.162,12.098-21.021,51.956-20.288,54.506c2.298,5.888,4.094,18.966-3.331,33.307c-1.02,3.909,2.119,17.11-3.633,12.871c-21.957-20.677-4.208-42.001-4.846-46.634c-0.762-5.534,6.612-54.5,9.843-62.684c3.557-9.398,6.779-41.158,7.518-46.35c5.001-31.322,13.832-38.236,22.815-39.45c4.935-0.296,24.939-5.972,26.441-8.071c0.415-0.229,1.331-9.251,1.389-10.475c0.062-1.155-4.469-11.89-5.506-14.177c-2.72,0.944-5.11-4.541-5.11-8.743c0-8.165,2.648-4.552,2.641-5.619c-0.007-0.795,0-3.077,0-6.718C66.739,5.537,80.178,0,87.41,0z";
        //this version have flat toe shape
        //path_data="M90.883,0c8.97,0,21.396,6.005,21.954,20.706c0,3.787,0.006,6.16,0,6.987c-0.009,1.109,2.745-2.648,2.745,5.843c0,4.37-2.486,10.076-5.315,9.092c-1.077,2.379-5.789,13.542-5.726,14.744c0.061,1.272,1.014,10.655,1.445,10.894c1.562,2.184,22.366,8.086,27.497,8.394c9.342,1.263,18.526,8.453,23.728,41.026c0.768,5.399,4.119,38.428,7.818,48.203c3.359,8.511,11.028,59.433,10.236,65.189c-0.663,4.818,17.796,26.995-5.039,48.498c-5.983,4.409-2.719-9.32-3.779-13.385c-7.722-14.915-5.853-28.516-3.464-34.639c0.763-2.651-15.73-44.103-21.099-56.684c-3.449-14.456-10.707-30.388-3.204-57.179c0.765-7.093-0.986-15.3-1.136-15.367c-0.172-0.067,1.858,6.642,0.875,14.365c-2.453,9.979-8.859,23.419-8.859,37.935c0,4.615,1.628,20.918,3.442,25.236c1.018,2.424,2.678,9.114,3.011,10.324c1.018,3.704,2.537,13.036,4.733,21.224c2.009,7.49,2.887,36.238,1.014,48.552c-1.647,10.805-10.117,33.581-13.319,56.558c-0.683,4.256-1.46,11.572-1.173,17.348c0.287,6.384,1.429,18.589,1.147,22.941c-0.391,11.272-12.242,64.11-13.107,70.875c-0.561,4.384,5.443,22.043,5.31,22.319c-3.649,0-12.099,0-13.723,0c-1.497,0-3.013,0-6.071,0c0.262-3.506,0.085-7.195,0.117-10.478c0.038-3.713,0.03-5.331,1.05-11.842c1.91-19.215-6.26-57.11-5.595-71.354c0.174-3.259,0.701-16.108-0.11-22.466c-3.49-18.763-1.387-41.354-4.409-72.776c-0.211-4.093-0.75-17.476-1.033-17.476c-0.283,0-0.822,13.383-1.033,17.476c-3.02,31.423-0.919,54.014-4.408,72.776c-0.81,6.357-0.284,19.207-0.109,22.466c0.665,14.243-7.505,52.14-5.596,71.354c1.021,6.511,1.013,8.127,1.05,11.842c0.033,3.282,0.118,10.241,0.118,10.478c-0.774,0-4.203,0-5.985,0c-2.183,0-12.647,0-13.814,0c-0.133-0.366,5.872-17.939,5.311-22.324c-0.865-6.765-12.718-59.604-13.108-70.875c-0.281-4.352,0.859-16.557,1.148-22.942c0.287-5.776-0.491-13.091-1.173-17.348c-3.201-22.977-11.673-45.753-13.32-56.558c-1.874-12.314-0.995-41.061,1.016-48.552c2.193-8.188,3.714-17.521,4.732-21.224c0.331-1.211,1.994-7.899,3.011-10.324c1.812-4.317,3.443-20.62,3.443-25.236c0-14.516-6.406-27.957-8.861-37.935c-0.982-7.724,1.047-14.433,0.875-14.365c-0.15,0.066-1.9,8.274-1.137,15.366c7.502,26.792,0.246,42.723-3.204,57.179c-5.369,12.582-21.861,54.033-21.099,56.685c2.391,6.123,4.258,19.724-3.464,34.638c-1.06,4.066,2.204,17.794-3.778,13.386c-22.834-21.503-4.376-43.68-5.04-48.498c-0.792-5.755,6.877-56.679,10.236-65.19c3.7-9.773,7.05-42.803,7.819-48.203c5.201-32.574,14.385-39.764,23.726-41.026c5.133-0.308,25.937-6.211,27.499-8.394c0.432-0.238,1.384-9.621,1.444-10.894c0.065-1.201-4.647-12.365-5.726-14.744c-2.829,0.981-5.315-4.723-5.315-9.093c0-8.491,2.754-4.733,2.747-5.844c-0.008-0.827,0-3.199,0-6.986C68.851,12.106,76.128,0,90.883,0z";
        // this version have adjusted neck and head points
        //path_data = "M91.258,0c7.525,0,21.508,5.761,22.065,20.469c0,3.788,0.007,9.222,0,10.049c-0.01,1.111,2.747-2.648,2.747,5.847c0,4.373-2.487,10.081-5.318,9.098c-1.079,2.379-5.792,12.779-5.729,13.981c0.061,1.274,1.014,11.414,1.446,11.652c1.563,2.186,22.377,11.167,27.512,11.474c9.347,1.263,18.534,8.458,23.739,41.048c0.768,5.401,4.122,38.448,7.822,48.226c3.362,8.515,11.034,51.051,10.241,56.809c-0.663,4.819,17.805,27.007-5.042,48.521c-5.986,4.412-2.72-9.323-3.78-13.391c-7.726-14.923-5.856-28.529-3.467-34.657c0.764-2.653-15.737-35.711-21.109-48.298c-3.452-14.465-10.711-30.404-3.206-57.209c0.765-7.096-0.987-15.306-1.137-15.374c-0.172-0.068,1.859,6.644,0.875,14.373c-2.454,9.982-8.864,23.43-8.864,37.954c0,4.618,1.631,20.929,3.444,25.248c1.018,2.426,2.68,9.118,3.013,10.33c1.019,3.704,2.538,6.923,4.735,15.114c2.01,7.495,2.89,36.255,1.015,48.577c-1.647,10.81-10.123,33.596-13.326,56.586c-0.683,4.258-1.461,11.577-1.173,17.356c0.289,6.388,1.43,18.6,1.147,22.952c-0.392,11.28-12.249,64.143-13.114,70.912c-0.561,4.388,3.589,18.896,5.314,22.355c-1.823,0-12.536,0-13.822,0c-1.496,0-5.984,0-5.984,0c0.262-3.507,0.085-7.223,0.117-10.507c0.038-3.717,0.03-5.334,1.053-11.849c1.908-19.224-6.264-57.138-5.599-71.39c0.175-3.261,0.7-16.116-0.111-22.476c-3.491-18.773-1.388-41.375-4.409-72.814c-0.212-4.095-1.259-21.302-1.259-21.302s-1.028,17.208-1.24,21.302c-3.021,31.439-0.918,54.041-4.409,72.814c-0.812,6.36-0.287,19.215-0.111,22.476c0.665,14.252-7.508,52.166-5.599,71.39c1.022,6.515,1.015,8.132,1.053,11.849c0.032,3.284-0.145,7,0.117,10.507c0,0-4.488,0-5.984,0c-1.286,0-11.999,0-13.822,0c1.725-3.46,5.875-17.968,5.314-22.355c-0.865-6.77-12.723-59.632-13.114-70.912c-0.282-4.352,0.858-16.563,1.147-22.952c0.288-5.779-0.49-13.098-1.173-17.356c-3.204-22.99-11.679-45.776-13.326-56.586c-1.875-12.321-0.995-41.082,1.015-48.577c2.196-8.191,3.716-11.411,4.735-15.114c0.333-1.211,1.995-7.904,3.013-10.33c1.813-4.318,3.444-20.629,3.444-25.248c0-14.524-6.41-27.972-8.864-37.954c-0.983-7.729,1.047-14.441,0.875-14.373c-0.149,0.068-1.901,8.278-1.137,15.374c7.505,26.806,0.246,42.744-3.205,57.209c-5.372,12.587-21.873,45.645-21.109,48.298c2.39,6.127,4.259,19.733-3.467,34.657c-1.06,4.067,2.206,17.803-3.78,13.391c-22.847-21.514-4.378-43.702-5.042-48.521c-0.793-5.758,6.879-48.294,10.241-56.809c3.7-9.777,7.054-42.824,7.822-48.226c5.204-32.59,14.392-39.785,23.739-41.048c5.134-0.307,25.949-9.288,27.512-11.474c0.432-0.238,1.385-10.378,1.445-11.652c0.063-1.202-4.649-11.602-5.729-13.981c-2.83,0.982-5.317-4.726-5.317-9.098c0-8.495,2.757-4.736,2.747-5.847c-0.007-0.827,0-6.261,0-10.049C69.441,5.761,83.319,0,91.258,0z";
        
        //mask_final_v1.svg 
        //path_data="M90.773,0c7.825,0,22.848,5.735,23.401,20.378c0,3.771,0.007,9.182,0,10.005c-0.01,1.106,2.735-0.645,2.735,7.813c0,4.352-2.476,11.031-5.294,10.053c-1.075,2.368-5.766,11.727-5.703,12.923c0.06,1.268,0.013,11.363,0.442,11.601c1.557,2.176,22.28,11.118,27.391,11.423c9.305,1.258,18.453,8.42,23.634,40.867c0.764,5.378,4.103,38.278,7.787,48.012c3.347,8.478,10.985,50.826,10.196,56.558c-0.661,4.798,17.726,26.888-5.02,48.306c-5.959,4.393-2.708-9.282-3.763-13.331c-7.691-14.858-5.831-28.404-3.452-34.504c0.76-2.641-15.667-35.553-21.016-48.084c-3.435-14.401-10.663-30.269-3.19-56.956c0.76-7.065-0.984-15.238-1.133-15.306c-0.171-0.068,1.85,8.606,0.871,16.301c-2.443,9.938-8.824,24.321-8.824,38.782c0,4.598,1.624,17.85,3.428,22.149c1.014,2.416,2.668,9.079,3,10.284c1.015,3.687,2.528,6.893,4.714,15.047c2.001,7.461,2.877,36.095,1.01,48.361c-1.639,10.762-10.077,33.448-13.267,56.335c-0.68,4.24-1.454,11.526-1.167,17.28c0.287,6.36,1.422,18.517,1.142,22.85c-0.389,11.23-10.212,58.857-11.074,65.597c-0.558,4.369,5.569,23.813,7.287,27.256c-1.815,0-16.458,0-17.739,0c-1.49,0-7.948,0-7.948,0c0.261-3.49,0.084-7.19,0.116-10.459c0.038-3.7,0.031-10.311,1.049-16.797c1.899-19.14-6.237-51.885-5.575-66.074c0.175-3.246,0.698-16.044-0.11-22.376c-3.476-18.69,0.609-41.192-2.398-72.492c-0.966-4.048-0.256-21.208-1.366-21.208c-1.068,0-0.516,17.159-1.482,21.208c-3.007,31.3,1.077,53.802-2.398,72.492c-0.808,6.332-0.285,19.13-0.11,22.376c0.662,14.189-7.475,46.935-5.575,66.074c1.018,6.486,1.011,13.097,1.049,16.797c0.031,3.269-0.145,6.969,0.116,10.459c0,0-6.458,0-7.948,0c-1.281,0-15.924,0-17.739,0c1.718-3.443,7.845-22.887,7.287-27.256c-0.861-6.74-10.685-54.367-11.074-65.597c-0.281-4.333,0.854-16.49,1.141-22.85c0.287-5.754-0.487-13.04-1.167-17.28c-3.19-22.888-11.627-45.573-13.266-56.335c-1.867-12.266-0.991-40.9,1.01-48.361c2.187-8.155,3.699-11.361,4.714-15.047c0.332-1.206,1.985-7.869,2.999-10.284c1.805-4.299,3.428-17.551,3.428-22.149c0-14.46-6.381-28.844-8.824-38.782c-0.979-7.695,1.042-16.369,0.871-16.301c-0.148,0.068-1.893,8.241-1.132,15.306c7.473,26.687,0.245,42.555-3.19,56.956c-5.348,12.531-21.776,45.443-21.016,48.084c2.379,6.1,4.24,19.646-3.451,34.504c-1.056,4.049,2.196,17.724-3.764,13.331c-22.746-21.418-4.358-43.508-5.02-48.306c-0.79-5.732,6.848-48.08,10.196-56.558c3.684-9.733,7.022-42.634,7.787-48.012c5.181-32.446,14.329-39.609,23.634-40.867c5.111-0.305,25.834-9.247,27.391-11.423c0.43-0.237,0.383-10.333,0.442-11.601c0.063-1.196-4.628-10.555-5.703-12.923c-2.817,0.978-5.294-5.701-5.294-10.053c0-8.458,2.745-6.707,2.735-7.813c-0.007-0.823,0-6.233,0-10.005C68.136,5.735,82.432,0,90.773,0z";
        //path_data="M90.773,0c7.825,0,22.848,5.735,23.4,20.378c0,3.771,0.008,9.182,0,10.005c-0.01,1.106,2.735-0.645,2.735,7.813c0,4.352-2.476,11.031-5.294,10.053c-1.075,2.368-5.766,11.727-5.703,12.923c0.061,1.268,0.013,11.363,0.442,11.601c1.557,2.176,22.279,11.118,27.391,11.423c9.305,1.258,18.453,8.42,23.634,40.867c0.765,5.378,4.104,38.278,7.787,48.012c3.348,8.478,10.985,50.826,10.196,56.558c-0.661,4.798,17.726,26.888-5.021,48.306c-5.959,4.393-2.708-9.282-3.763-13.331c-7.69-14.858-5.831-28.404-3.452-34.504c0.761-2.641-15.667-35.553-21.016-48.084c-3.436-14.401-10.663-30.269-3.19-56.956c0.761-7.065-0.983-15.238-1.133-15.306c-0.171-0.068,1.851,8.606,0.871,16.301c-2.443,9.938-8.824,24.321-8.824,38.782c0,4.598,1.624,17.85,3.429,22.149c1.014,2.416,2.668,9.079,3,10.284c1.015,3.687,2.527,6.893,4.714,15.047c2.001,7.461,2.877,36.095,1.01,48.361c-1.639,10.762-10.077,33.448-13.267,56.335c-0.681,4.24-1.454,11.526-1.167,17.28c0.286,6.36,1.422,18.517,1.142,22.85c-0.389,11.23-10.212,58.857-11.074,65.597c-0.558,4.369,5.569,23.813,7.287,27.256c-1.815,0-16.458,0-17.739,0c-1.489,0-7.947,0-7.947,0c0.261-3.49,0.084-7.189,0.115-10.459c0.038-3.699,0.031-10.311,1.05-16.797c1.898-19.14-6.237-51.885-5.575-66.074c0.175-3.246,0.697-16.044-0.11-22.376c-3.476-18.69,0.609-41.192-2.397-72.492c-0.967-4.048-0.257-21.208-1.366-21.208c-1.068,0-0.517,17.159-1.482,21.208c-3.007,31.3,1.077,53.802-2.397,72.492c-0.809,6.332-0.285,19.13-0.11,22.376c0.662,14.189-7.475,46.936-5.575,66.074c1.019,6.486,1.011,13.098,1.049,16.797c0.031,3.27-0.145,6.969,0.116,10.459c0,0-6.458,0-7.948,0c-1.28,0-15.924,0-17.738,0c1.718-3.443,7.845-22.887,7.287-27.256c-0.861-6.74-10.686-54.367-11.074-65.597c-0.281-4.333,0.854-16.49,1.141-22.85c0.287-5.754-0.487-13.04-1.167-17.28c-3.189-22.888-11.627-45.573-13.266-56.335c-1.867-12.266-0.991-40.9,1.01-48.361c2.188-8.155,3.699-11.361,4.714-15.047c0.332-1.206,1.985-7.869,2.999-10.284c1.805-4.299,3.428-17.551,3.428-22.149c0-14.46-6.381-28.844-8.823-38.782c-0.979-7.695,1.042-16.369,0.871-16.301c-0.148,0.068-1.894,8.241-1.133,15.306c7.474,26.687,0.245,42.555-3.189,56.956c-5.349,12.531-21.776,45.443-21.017,48.084c2.38,6.1,4.24,19.646-3.45,34.504c-1.057,4.049,2.195,17.724-3.765,13.331c-22.746-21.418-4.357-43.508-5.02-48.306c-0.79-5.732,6.848-48.08,10.195-56.558c3.685-9.733,7.022-42.634,7.787-48.012c5.182-32.446,14.329-39.609,23.635-40.867c5.11-0.305,25.834-9.247,27.391-11.423c0.43-0.237,0.383-10.333,0.442-11.601c0.063-1.196-4.628-10.555-5.703-12.923c-2.817,0.978-5.294-5.701-5.294-10.053c0-8.458,2.745-6.707,2.734-7.813c-0.007-0.823,0-6.233,0-10.005C68.136,5.735,82.432,0,90.773,0z";            
       
       //srouce file : mask_final_v2.svg 
        path_data="M89.515,0c14.962,0,23.395,10.368,23.395,19.515c0,3.797,0.007,8.21,0,9.038c-0.011,1.114,2.753-0.649,2.753,7.865c0,4.382-2.493,13.106-5.329,12.121c-0.399,3.479-0.815,6.923-5.742,15.023c0.06,1.276,0.014,9.788,0.445,10.026c3.286,5.789,25.403,8.759,30.574,10.5c9.019,3.02,16.548,9.686,21.794,40.914c0.77,5.414,1.13,36.415,4.839,46.214c3.372,8.534,11.06,51.167,10.264,56.938c-0.666,4.832,17.846,27.069-5.053,48.631c-6,4.421-2.726-9.344-3.79-13.422c-7.741-14.957-5.869-28.593-3.474-34.734c0.766-2.66-15.772-35.793-21.157-48.408c-3.458-14.498-8.734-29.472-1.211-56.339c0.767-7.112-0.991-18.367-1.14-18.436c-0.173-0.068,1.862,7.665,0.877,15.411c-2.459,10.005-8.883,28.512-8.883,43.069c0,4.629,1.634,16.97,3.45,21.298c1.021,2.43,2.685,9.139,3.02,10.353c1.021,3.711,2.543,6.938,4.745,15.147c2.015,7.513,2.896,36.338,1.017,48.687c-1.65,10.834-10.144,33.672-13.354,56.713c-0.684,4.27-1.464,11.604-1.175,17.396c0.289,6.405,1.431,18.641,1.148,23.001c-0.392,11.307-10.282,59.255-11.149,66.039c-0.561,4.399,5.607,23.972,7.337,27.438c-1.827,0-16.569,0-17.857,0c-1.501,0-8.001,0-8.001,0c0.261-3.514,0.085-7.236,0.116-10.529c0.039-3.723,0.031-10.379,1.056-16.909c1.912-19.267-6.279-52.233-5.612-66.517c0.176-3.268,0.703-16.15-0.111-22.525c-3.497-18.817,0.614-41.471-2.413-72.979c-0.973-4.076-0.743-21.351-1.4-21.351c-0.636,0-0.465,17.275-1.438,21.351c-3.027,31.509,1.084,54.163-2.413,72.979c-0.814,6.375-0.287,19.258-0.112,22.525c0.667,14.283-7.524,47.25-5.612,66.517c1.025,6.53,1.018,13.187,1.056,16.909c0.031,3.293-0.146,7.016,0.116,10.529c0,0-6.5,0-8.001,0c-1.288,0-16.03,0-17.857,0c1.729-3.467,7.897-23.039,7.337-27.438c-0.867-6.784-10.758-54.731-11.149-66.039c-0.283-4.361,0.859-16.597,1.148-23.001c0.289-5.793-0.491-13.126-1.175-17.396c-3.211-23.041-11.705-45.878-13.355-56.713c-1.879-12.349-0.998-41.174,1.017-48.687c2.202-8.209,3.724-11.437,4.745-15.147c0.334-1.214,1.999-7.922,3.02-10.353c1.816-4.328,3.45-16.669,3.45-21.298c0-14.557-6.424-33.064-8.883-43.069c-0.985-7.746,1.05-15.479,0.877-15.411c-0.148,0.069-1.906,11.324-1.14,18.436c7.523,26.867,2.247,41.841-1.211,56.339c-5.385,12.615-21.923,45.748-21.157,48.408c2.396,6.141,4.268,19.777-3.474,34.734c-1.064,4.078,2.209,17.843-3.791,13.422c-22.898-21.562-4.386-43.8-5.052-48.631c-0.796-5.771,6.892-48.403,10.264-56.938c3.708-9.799,4.069-40.8,4.839-46.214c5.246-31.228,12.775-37.894,21.793-40.914c5.172-1.741,27.609-4.874,30.575-10.5c0.431-0.239,0.385-8.75,0.445-10.026c-4.927-8.1-5.343-11.545-5.742-15.023c-2.835,0.985-5.329-7.739-5.329-12.121c0-8.514,2.764-6.751,2.753-7.865c-0.007-0.828,0-5.241,0-9.038C66.036,11.328,73.207,0,89.515,0z";
      
      
        full_scr_mask = new Path(path_data);
        def_mask_height = full_scr_mask.bounds.height;
        adjusted_mask_height_px = (adjusted_mask_height_px * 100) / 450;
        full_scr_mask.scale(init_scale_ratio(),adjusted_mask_height_px/100);
         
         
    function init_scale_ratio(){
            var def_scale = full_scr_mask.segments[17].point.x - full_scr_mask.segments[53].point.x;
            var init_req_scale = parseFloat(liquid_mask.dm_body_parts_details_json.bust_px) * 0.5213;
            var set_init_scale_ratio = init_req_scale / def_scale;
            return set_init_scale_ratio;
        }
    function implement_body_part_px(dm_body_part_name,dm_seg_1,dm_seg_2,user_body_part_ele_id){
        var dm_body_part = full_scr_mask.segments[dm_seg_1].point.x - full_scr_mask.segments[dm_seg_2].point.x;
        var user_body_part_px = parseFloat($("#"+user_body_part_ele_id).attr("value"));
        user_body_part_px = user_body_part_px * 0.5213;
        var body_part_diff = Math.abs(dm_body_part - user_body_part_px);
        full_scr_mask.segments[dm_seg_1].point.x += body_part_diff/2;
        full_scr_mask.segments[dm_seg_2].point.x -= body_part_diff/2;
    }

    // Bust adjustment 
    implement_body_part_px("bust",17,53,"user_bust_px");
    implement_body_part_px("waist",18,52,"user_waist_px");
    implement_body_part_px("hip",21,49,"user_hip_px");

    // iPhone6 retake screen settings /// available screen for mask 633.5 in camera view.
    full_scr_mask.pivot = new Point(full_scr_mask.bounds.bottomCenter);
    full_scr_mask.position = new Point(187.5,667 - (667 * 0.05));
    
    toeShape(full_scr_mask, 667 * 0.0328125);


    // Arms settings
    rgt_arm_ref = new Path({});
    lft_arm_ref = new Path({});
    rgt_arm_ref = get_path_seg(rgt_arm_ref, full_scr_mask, 7, 16);
    lft_arm_ref = get_path_seg(lft_arm_ref, full_scr_mask, 55, 64);
    //rgt_arm_ref.position.x += 60;
    rgt_arm_ref.selected = true;
    lft_arm_ref.selected = true;


    //rgt_arm_ref.segments[7].point.x += 20;
    pivot_path = new Path();
    pivot_path.add(rgt_arm_ref.segments[0]);
    rgt_arm_ref.pivot = new Point(pivot_path.position);

    pivot_path_lft = new Path();
    pivot_path_lft.add(lft_arm_ref.segments[8]);
    lft_arm_ref.pivot = new Point(pivot_path_lft.position);

    }

    function get_path_seg(ref_part_obj, obj_path_for_ref, int_seg_num, end_seg_num){

        ref_part_obj.removeSegments();

        for(var i = int_seg_num; i < end_seg_num; i++) {
            ref_part_obj.add(obj_path_for_ref.segments[i]);
        }

        return ref_part_obj;
    }

    function set_path_seg(ref_part_obj, obj_path_for_ref, int_seg_num, end_seg_num){
        ind = 0;
        for(var i = int_seg_num; i < end_seg_num; i++) {
            //debugger;
            obj_path_for_ref.segments[i].point = ref_part_obj.segments[ind].point;
            obj_path_for_ref.segments[i].handleIn = ref_part_obj.segments[ind].handleIn;
            obj_path_for_ref.segments[i].handleOut = ref_part_obj.segments[ind].handleOut;
            ind++;
        }

        return ref_part_obj;
    }
    function set_arm_inner_to_bust(){
    full_scr_mask.segments[55].point.x = full_scr_mask.segments[53].point.x;
    full_scr_mask.segments[15].point.x = full_scr_mask.segments[17].point.x; 
    }
    function set_arm_rgt(){
        if(rgt_arm_ref.segments[7].point.x <= full_scr_mask.segments[21].point.x + 2) {
            console.log(rgt_arm_ref.segments[7].point.x +" <= "+ full_scr_mask.segments[19].point.x);

            rgt_arm_ref.rotate(-0.5);
            lft_arm_ref.rotate(0.5);
            view.update();
            set_arm_rgt();
        }else{
            rgt_arm_ref = set_path_seg(rgt_arm_ref, full_scr_mask, 7, 16);
            lft_arm_ref = set_path_seg(lft_arm_ref, full_scr_mask, 55, 64);

            set_arm_inner_to_bust();
            set_camera_mask();
        }
        rgt_arm_ref.visible = false;
        lft_arm_ref.visible = false;

        view.update();
    }




    function set_camera_mask(){
        
        camera_scr_mask = new Path(full_scr_mask.pathData);
        camera_scr_mask.pivot = new Point(camera_scr_mask.bounds.bottomCenter);
        camera_scr_mask = camera_scr_mask.scale(0.750, 0.750);
        camera_scr_mask.selected = true;

        /// iPhone6 camera screen settings /// available screen for mask 475.125 in camera view.
        camera_scr_mask.position = new Point(187.5,500.25 - (500.25 * 0.0171875));
        //camera_scr_mask.position = new Point(187.5,500.25 - (500.25 * 0.05));
        
        
        
        
        
        camera_scr_mask.visible = false;

        full_scr_mask.selected = true;
        full_scr_mask.visible = true;
        
      // toe shape 
        //toe shape for camera screen 
       
         
        

        $("#svg_path_data").attr("value", camera_scr_mask.pathData);
        $("#svg_path_data_full").attr("value", full_scr_mask.pathData);

//        $("#side_svg_path_data").attr("value", camera_scr_mask.pathData);
//        $("#side_svg_path_data_full").attr("value", full_scr_mask.pathData);
//
//        $("#back_svg_path_data").attr("value", camera_scr_mask.pathData);
//        $("#back_svg_path_data_full").attr("value", full_scr_mask.pathData);
        view.update();

   window.location.href = "svg_path_created";

    }
 
function toeShape(obj, toe_shape_px){
 //left foot
          //obj.segments[27].handleOut = new Point(7, 19);
          obj.segments[28].point.y += toe_shape_px;
          //obj.segments[28].point.x += 2;
          obj.segments[28].handleIn = new Point((toe_shape_px * 1.4), -(toe_shape_px * 0.2));
          obj.segments[28].handleOut = new Point(-(toe_shape_px * 0.5), 0);
          //obj.segments[28].handleOut = new Point(0, 0);
          //obj.segments[29].handleOut = new Point(2.43237, -11);
          //obj.segments[29].handleIn = new Point(-5, 31);
        
 //right foot
          //obj.segments[43].handleIn = new Point(-7, 19);
          obj.segments[42].point.y += toe_shape_px;
          //obj.segments[42].point.x -= 2;
          obj.segments[42].handleOut = new Point(-(toe_shape_px * 1.4), -(toe_shape_px * 0.2));
          obj.segments[42].handleIn = new Point((toe_shape_px * 0.5), 0);
          //obj.segments[42].handleIn = new Point(0, 0);
          //obj.segments[41].handleIn = new Point(-2.43237, -11);
          //obj.segments[41].handleOut = new Point(5,  31);      
} 


}
 
 
 
 
 
 