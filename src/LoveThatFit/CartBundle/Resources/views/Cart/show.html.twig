{% extends 'LoveThatFitUserBundle:Profile:baseProfile.html.twig' %}

{% block profile_heading %}

    <h1>Shopping Cart</h1>
{% endblock %}
{% block profile_section %}
    {% if app.session.hasFlash('warning') %}
        <div class="alert alert-error">
            {{ app.session.flash('warning') }}
        </div>
    {% endif %}
    {% if app.session.hasFlash('success') %}
        <div class="success_alert">
            {{ app.session.flash('success') }}
        </div>
    {% endif %}

<script type="text/javascript">

    $(document).ready(function() {

        $('#cart').validate({ // initialize plugin within DOM ready
            // other options,
            rules: {
                'qty[]': {
                    required: true,
                    minlength: 1
                }
            }
        });

    });
</script>
    <table width="700" border="0" class="user_product_hd">
        <tr>
            <td>Image</td>
            <td>SKU</td>
            <td>Product</td>
            <td>Quantity</td>
            <td>Unit Price</td>
            <td>Sub Total</td>
            <td>-</td>

        </tr>
        <form method="post" action="{{ path('cart_basket_update')}}" id="cart" onsubmit="return validates();">
            {% for c in cart %}
            <tr>
                <td><img src="{{ asset(c.productItem.productColor.webPath) }}"></td>
                <td>{{ c.productItem.sku}}</td>
                <td>{{ c.productItem.product.brand.name}} {{ c.productItem.product.name}} {{ c.productItem.productColor.title}} {{ c.productItem.productSize.title}}</td>
                <td><input type="hidden" name="id[]" value="{{ c.id }}"><input type="hidden" id="product_item" name="product_item[]" value="{{ c.productItem.id }}"> <input type="text" name="qty[]" value="{{ c.qty }}" size="4" required="required" > </td>
                <td>${{ c.productItem.price}}</td>
                <td>${{ c.productItem.price * c.qty}}</td>

                <td><a href="{{ path('cart_delete', {'id': c.id}) }}">Delete</a></td>

            </tr>

        {% else %}
            <tr><td align="center" colspan="6"><p>No Items</p></td></tr>
        {% endfor %}
        <tr><td colspan="7" align="right">Total:<strong>${{ grand_total }}<input type="hidden" name="order_amount" value="{{ grand_total }}"> </strong></td></tr>
        <tr><td colspan="3" align="right"><input type="submit" name="update" value="update"></td><td><input type="submit" name="checkout" value="checkout"></td></tr>
        </form>
    </table>

{% endblock %}