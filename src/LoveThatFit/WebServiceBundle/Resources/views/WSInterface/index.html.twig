{% extends 'LoveThatFitAdminBundle::base.html.twig' %}
{% block breadcrumb %}
<li class="active">Web Services Client</li>
{% endblock %}



{% block body %}

<div class="p_listing">     
    <h3>Web Services Client</h3>
    <form class="form-inline">
        <div class="form-group">
            <label for="sel_service">Service</label>
            <select id="sel_service" class="form-control">
                <option>select</option>
                {% for k,v in services %}
                <option value="{{v['pattern']}}">{{ k }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="sel_user">User</label>
            <select id="sel_user" class="form-control">
                <option>select</option>
                {% for k,v in users  %}
                <option value="{{v.authToken}}">{{ v.email }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="checkbox">
            <label>
                <input id="chk_new_window" type="checkbox"> New
            </label>
        </div>
        <button type="submit" class="btn btn-default">Submit</button>
    </form>
    <br>
    <div id='service_description'>
        adsasdads
    </div>
    <div id='backend_process'>
        adsasdads
    </div>
    <div class="form-group">
        <label for="txt_request_params">Request Params</label>
        <input type=text id="txt_request_params"/>
    </div>
      <div class="form-group">
        <label for="txt_optional_params">Optional Params</label>
        <input type=text id="txt_optional_params"/>
    </div>
    <div class="form-group">
        <label for="txt_response_params">Response</label>
        <input type=text id="txt_response_params"/>
    </div>   




    <script type="text/javascript" src="{{ asset('bundles/lovethatfit/site/js/jquery-1.8.3.min.js') }}"></script> 
    <script  type='text/javascript'>
    //-------------------------------------------------------
    {% autoescape false %};
    var j = '{{ services|json_encode()}}';
    var services_obj = JSON.parse(j);
    {% endautoescape %}
        
    //-------------------------------------------------------
    //------------- service dropdownlist --------------------------

    $("#sel_service").change(function() {      
        tt = $('option:selected', this).html();
        show_service_detail(tt);          
    });

    //------------------- user dropdownlist --------------------
    $("#sel_user").change(function() {  
      alert($('option:selected', this).html());  
    });

      //--------------------------------------------------
     function show_service_detail(service_name){         
         if (tt=='select'){
            $('#service_description').html('');
            $('#backend_process').html('');
            $('#txt_request_params').val('');
            $('#txt_response_params').val("");
            $('#txt_optional_params').val("");
        }else{
            service_detail = find_service_obj(service_name);          
            $('#service_description').html(service_detail.description);
            $('#backend_process').html(service_detail.backend_process);
            $('#txt_request_params').val(JSON.stringify(service_detail.params));
            $('#txt_optional_params').val(JSON.stringify(service_detail.optional_params));
            $('#txt_response_params').val("");
        }
    } 
    
      //--------------------------------------------------
     function find_pattern(service_name){    
        service_detail = find_service_obj(service_name);
        return service_detail.pattern;    
    } 
    //--------------------------------------------------
    function find_service_obj(service_name){    
        for(var key in  services_obj)
           if(key==service_name)
                return services_obj[key];                     
    }
    
    
        </script>



{% endblock %}
